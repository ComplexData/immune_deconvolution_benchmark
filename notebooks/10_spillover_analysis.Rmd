---
title: "Spillover"
output: html_notebook
---


```{r setup}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(Biobase, 
               readxl,
               tidyverse,
               testit)

```

Part 1 of the immune deconvolution benchmark: The Spillover analysis. 

* take pure samples of the given cell types (ideally not from the training data)
* negative control (something completly different)
* positive control = blood (should contain everything)
* NGS vs. microarray? 
-> NGS is more important 


# Data
## Single Cell
* Human cell atlas (https://www.humancellatlas.org/): News item claims that single cell data of 1e6 immune cells is already available
* 10X genomics PBMC https://support.10xgenomics.com/single-cell-gene-expression/datasets/2.1.0/pbmc8k


## Build tissue 
* Fantom5 

```{r}
# load and rename fantom5 data
load("./data/f5_expressionset.Rdata")
f5_eset = expr.set

# load annotation about cell types
annotation = read_xlsx("./tables/fantom5_pdata.xlsx")
assert("annotation files consistent", annotation$lib_id == rownames(pData(f5_eset)))

pData(f5_eset)$cell_type = annotation$`cell type`

f5_eset_fil = f5_eset[,!is.na(pData(f5_eset)$cell_type)]
```






