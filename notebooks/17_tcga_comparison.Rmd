# Correlation of methods across TCGA samples. 

```{r, fig.width=12, fig.height=12, cache=TRUE}
tcga_infiltration = tbl(tcga_db, "infiltration") %>%
  collect() %>% 
  filter(method != "cibersort") %>% # cibersort does not make senes here, as it only compares relative fractions. 
  mutate(method_cell_type = paste0(cell_type, " [", method, "]")) %>%
  select(sample, method_cell_type, estimate) %>%
  spread(method_cell_type, estimate)

tcga_infil_mat = tcga_infiltration %>%
  select(-sample) %>% 
  as.matrix()

tcga_cor = cor(tcga_infil_mat)

pheatmap(tcga_cor, clustering_distance_rows = "correlation", clustering_distance_cols = "correlation")
```